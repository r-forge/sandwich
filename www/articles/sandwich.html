<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>sandwich: Robust Covariance Matrix Estimators • sandwich</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="sandwich: Robust Covariance Matrix Estimators">
<meta property="og:description" content="sandwich">
<meta property="og:image" content="https://sandwich.R-Forge.R-project.org/logo.png">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@AchimZeileis">
<meta name="twitter:site" content="@AchimZeileis">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sandwich</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/sandwich.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jss_2004.html">Econometric Computing with HC and HAC Covariance Matrix Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2006.html">Object-Oriented Computation of Sandwich Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2020.html">Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>sandwich: Robust Covariance Matrix
Estimators</h1>
                        <h4 data-toc-skip class="author">Achim Zeileis,
Thomas Lumley, Nathaniel Graham, Susanne Köll</h4>
            
      
      
      <div class="hidden name"><code>sandwich.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <a href="https://CRAN.R-project.org/package=sandwich" class="external-link"><strong>sandwich</strong></a>
package is designed for obtaining covariance matrix estimators of
parameter estimates in statistical models where certain model
assumptions have been violated. More specifically, the estimators are
useful in a situation where the model’s score function was correctly
specified (e.g., the mean function in a linear regression model) but
that the remaining likelihood was potentially misspecified (e.g., due to
heteroscedasticity or a lack of independence). In this case, the usual
parameter estimates are still consistent but the associated covariance
matrix estimate is not, thus potentially biasing the inference such as
parameter tests or confidence intervals. Luckily, there are covariance
matrix estimators that are consistent under these misspecifications and
that can simply be plugged in to the usual inference based on the
central limit theorem. Because the covariance matrix estimators are a
product of two outer “bread” matrices (based on the Hessian of the
log-likelihood) and an innter “meat” matrix (based on cross-products of
the corresponding score function), they are also known as “sandwich”
covariances.</p>
<p>The <em>sandwich</em> package provides a wide range of such sandwich
covariances in an object-oriented framework. This means that it takes
the models fitted by another package without any modification or
adjustment, extracts certain quantities from them, and computes the
different covariance matrices based on these. For <em>sandwich</em> to
work the model class has to provide at least an <code><a href="../reference/estfun.html">estfun()</a></code>
method for extracting the score matrix (containing the gradient
contributions per observation) and a <code><a href="../reference/bread.html">bread()</a></code> method for
extracting the inverse of some estimate of the Fisher information (that
most of the “usual” covariances are based on). Some sandwich covariances
also need further methods, e.g., <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix()</a></code> or
<code><a href="https://rdrr.io/r/stats/influence.measures.html" class="external-link">hatvalues()</a></code> etc. The covariances provided are:</p>
<ul>
<li>Basic <code><a href="../reference/sandwich.html">sandwich()</a></code> for cross-section data.</li>
<li>
<code><a href="../reference/vcovHC.html">vcovHC()</a></code> for heteroscedasticity-consistent (HC)
covariances in (generalized) linear models.</li>
<li>
<code><a href="../reference/vcovHAC.html">vcovHAC()</a></code> for heteroscedastiticy- and
autocorrelation-consistent (HAC) covariances in time series data with
convenience interfaces <code><a href="../reference/weightsAndrews.html">kernHAC()</a></code> (Andrews’ kernel HAC
estimator), <code><a href="../reference/NeweyWest.html">NeweyWest()</a></code>, and <code><a href="../reference/weightsLumley.html">weave()</a></code> (weighted
empirical adaptive variance estimation by Lumley and Heagerty).</li>
<li>
<code><a href="../reference/vcovCL.html">vcovCL()</a></code> for clustered covariances (including multiway
clustering).</li>
<li>
<code><a href="../reference/vcovPL.html">vcovPL()</a></code> and <code><a href="../reference/vcovPC.html">vcovPC()</a></code> for panel and
panel-corrected covariances.</li>
<li>
<code><a href="../reference/vcovOPG.html">vcovOPG()</a></code> for outer-product-of-gradients
covariances.</li>
<li>
<code><a href="../reference/vcovBS.html">vcovBS()</a></code> for bootstrap covariances (with default method
and dedicated fast and more flexible methods for <code>lm</code> and
<code>glm</code> objects).</li>
</ul>
<p>These can be applied to many different model classes, including
<code>lm</code>, <code>glm</code>, <code>survreg</code>,
<code>coxph</code>, <code>mlogit</code>, <code>polr</code>,
<code>hurdle</code>, <code>zeroinfl</code>, <code>ivreg</code>,
<code>betareg</code>, and many more. (There are some exceptions, though,
not all covariances are applicable to all models).</p>
<p>The resulting covariances can be subsequently plugged in to various
functions for Wald-type inference, including <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code>,
<code><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html" class="external-link">waldtest()</a></code>, and <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coefci()</a></code> from the <a href="https://CRAN.R-project.org/package=lmtest" class="external-link"><strong>lmtest</strong></a>
package or <code>Anova()</code>, <code>Confint()</code>,
<code>S()</code>, <code>linearHypothesis()</code>, and
<code>deltaMethod()</code> from <a href="https://CRAN.R-project.org/package=car" class="external-link"><strong>car</strong></a>
package.</p>
<p>Several R packages can be used to create model summary tables or
visualizations based on the covariance and inference functions above. In
particular <a href="https://broom.tidymodels.org/" class="external-link"><strong>broom</strong></a> provides
a unified interface for collecting information about models, including a
method for <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> objects. Based on <em>broom</em>
several packages provide model summary tables with the <a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link"><strong>modelsummary</strong></a>
package being particularly versatile, including a graphical
<code><a href="https://modelsummary.com/man/modelplot.html" class="external-link">modelplot()</a></code> to go along with the tabular
<code><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>The stable release version of <em>sandwich</em> is hosted on the
Comprehensive R Archive Network (CRAN) at <a href="https://CRAN.R-project.org/package=sandwich" class="external-link uri">https://CRAN.R-project.org/package=sandwich</a> and can be
installed via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sandwich"</span><span class="op">)</span></span></code></pre></div>
<p>The development version of <em>sandwich</em> is hosted on R-Forge at
<a href="https://R-Forge.R-project.org/projects/sandwich/" class="external-link uri">https://R-Forge.R-project.org/projects/sandwich/</a> in a
Subversion (SVN) repository. It can be installed via</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"sandwich"</span>, repos <span class="op">=</span> <span class="st">"https://R-Forge.R-project.org"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="publications">Publications<a class="anchor" aria-label="anchor" href="#publications"></a>
</h2>
<p>The package development was accompanied by three publications in the
<em>Journal of Statistical Software</em>, describing the initial HC and
HAC implementation for linear models, the corresponding object-oriented
extension, and the generalization to clustered and panel covariances,
respectively.</p>
<ul>
<li>Zeileis A (2004). “Econometric Computing with HC and HAC Covariance
Matrix Estimators.” <em>Journal of Statistical Software</em>,
<strong>11</strong>(10), 1-17. <a href="https://doi.org/10.18637/jss.v011.i10" class="external-link">doi:10.18637/jss.v011.i10</a>.</li>
<li>Zeileis A (2006). “Object-Oriented Computation of Sandwich
Estimators.” <em>Journal of Statistical Software</em>,
<strong>16</strong>(9), 1-16. <a href="https://doi.org/10.18637/jss.v016.i09" class="external-link">doi:10.18637/jss.v016.i09</a>.</li>
<li>Zeileis A, Köll S, Graham N (2020). “Various Versatile Variances: An
Object-Oriented Implementation of Clustered Covariances in R.”
<em>Journal of Statistical Software</em>, <strong>95</strong>(1), 1-36.
<a href="https://doi.org/10.18637/jss.v095.i01" class="external-link">doi:10.18637/jss.v095.i01</a>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="illustrations">Illustrations<a class="anchor" aria-label="anchor" href="#illustrations"></a>
</h2>
<p>To illustrate the functionality of the <code>sandwich</code> package
we employ a well-known data set that was created by Petersen for
benchmarking clustered standard errors. However, because the data is so
simple, we will use it here to illustrate all sorts of covariances (not
only clustered ones).</p>
<p>The data come from a simple linear regression of a response
<code>y</code> on an explanatory variable <code>x</code>, but the data
are clustered by <code>firm</code> (500 firms) and <code>year</code> (10
years). The data can be loaded and the model fitted by ordinary least
squares (OLS):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PetersenCL"</span>, package <span class="op">=</span> <span class="st">"sandwich"</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">PetersenCL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## lm(formula = y ~ x, data = PetersenCL)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residuals:</span></span>
<span><span class="co">##    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">## -6.761 -1.368 -0.017  1.339  8.678 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Coefficients:</span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)   0.0297     0.0284    1.05      0.3    </span></span>
<span><span class="co">## x             1.0348     0.0286   36.20   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Residual standard error: 2.01 on 4998 degrees of freedom</span></span>
<span><span class="co">## Multiple R-squared:  0.208,  Adjusted R-squared:  0.208 </span></span>
<span><span class="co">## F-statistic: 1.31e+03 on 1 and 4998 DF,  p-value: &lt;2e-16</span></span></code></pre>
<p>The regression summary for a linear model uses the “usual” OLS
standard errors, assuming that the data are uncorrelated and
homoscedastic. The summary provides partial Wald tests for the
regression coefficients and also an over <em>F</em> test assessing all
the regressors, i.e., in this case equivalent to a <em>t</em> test of
<code>x</code>. To obtain the analogous tests and corresponding
confidence intervals using the basic “robust” sandwich covariance for
cross-section data we can combine <em>sandwich</em> with the
<em>lmtest</em> package:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://sandwich.R-Forge.R-project.org/">"sandwich"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"lmtest"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest</a></span><span class="op">(</span><span class="va">m</span>, vcov <span class="op">=</span> <span class="va">sandwich</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## t test of coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)   0.0297     0.0284    1.05      0.3    </span></span>
<span><span class="co">## x             1.0348     0.0284   36.45   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coefci</a></span><span class="op">(</span><span class="va">m</span>, vcov <span class="op">=</span> <span class="va">sandwich</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##               2.5 % 97.5 %</span></span>
<span><span class="co">## (Intercept) -0.0259 0.0853</span></span>
<span><span class="co">## x            0.9792 1.0905</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">PetersenCL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/waldtest.html" class="external-link">waldtest</a></span><span class="op">(</span><span class="va">m0</span>, <span class="va">m</span>, vcov <span class="op">=</span> <span class="va">sandwich</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Wald test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Model 1: y ~ 1</span></span>
<span><span class="co">## Model 2: y ~ x</span></span>
<span><span class="co">##   Res.Df Df    F Pr(&gt;F)    </span></span>
<span><span class="co">## 1   4999                   </span></span>
<span><span class="co">## 2   4998  1 1329 &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>Other covariances can be plugged in analogously, potentially passing
along further options for the covariance. For example, the clustered
covariance <code><a href="../reference/vcovCL.html">vcovCL()</a></code> can be used with the clustering
variable <code>firm</code> as:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest</a></span><span class="op">(</span><span class="va">m</span>, vcov <span class="op">=</span> <span class="va">vcovCL</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## t test of coefficients:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">## (Intercept)   0.0297     0.0670    0.44     0.66    </span></span>
<span><span class="co">## x             1.0348     0.0506   20.45   &lt;2e-16 ***</span></span>
<span><span class="co">## ---</span></span>
<span><span class="co">## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre>
<p>In the same way we can compute and compare many of the other
estimators in the package. A selection, mostly just with the default
settings, is provided here. First, the covarainces are computed and then
the corresponding standard errors extracted (square root of the
diagonal):</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Standard"</span>              <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Sandwich (basic)"</span>      <span class="op">=</span> <span class="fu"><a href="../reference/sandwich.html">sandwich</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Clustered"</span>             <span class="op">=</span> <span class="fu"><a href="../reference/vcovCL.html">vcovCL</a></span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span><span class="op">)</span>,</span>
<span>  <span class="st">"Clustered (two-way)"</span>   <span class="op">=</span> <span class="fu"><a href="../reference/vcovCL.html">vcovCL</a></span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span> <span class="op">+</span> <span class="va">year</span><span class="op">)</span>,</span>
<span>  <span class="st">"HC3"</span>                   <span class="op">=</span> <span class="fu"><a href="../reference/vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Andrews' kernel HAC"</span>   <span class="op">=</span> <span class="fu"><a href="../reference/weightsAndrews.html">kernHAC</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Newey-West"</span>            <span class="op">=</span> <span class="fu"><a href="../reference/NeweyWest.html">NeweyWest</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Bootstrap"</span>             <span class="op">=</span> <span class="fu"><a href="../reference/vcovBS.html">vcovBS</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>,</span>
<span>  <span class="st">"Bootstrap (clustered)"</span> <span class="op">=</span> <span class="fu"><a href="../reference/vcovBS.html">vcovBS</a></span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">vc</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                       (Intercept)      x</span></span>
<span><span class="co">## Standard                   0.0284 0.0286</span></span>
<span><span class="co">## Sandwich (basic)           0.0284 0.0284</span></span>
<span><span class="co">## Clustered                  0.0670 0.0506</span></span>
<span><span class="co">## Clustered (two-way)        0.0651 0.0536</span></span>
<span><span class="co">## HC3                        0.0284 0.0284</span></span>
<span><span class="co">## Andrews' kernel HAC        0.0437 0.0351</span></span>
<span><span class="co">## Newey-West                 0.0660 0.0482</span></span>
<span><span class="co">## Bootstrap                  0.0262 0.0292</span></span>
<span><span class="co">## Bootstrap (clustered)      0.0651 0.0544</span></span></code></pre>
<p>This shows that due to the cluster-correlation in the data, the usual
standard errors and cross-section covariances are much too small. In
contrast, the different types of clustered standard errors are much
larger and more appropriate here.</p>
</div>
<div class="section level2">
<h2 id="tables-and-visualizations">Tables and visualizations<a class="anchor" aria-label="anchor" href="#tables-and-visualizations"></a>
</h2>
<p>For creating publication-quality tables of the model summaries using
<em>sandwich</em>-based standard errors, we use the
<code><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary()</a></code> function from the <em>modelsummary</em> package.
Similar to <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> this takes the unmodified
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code> object <code>m</code> along with a <code>vcov</code>
specification (starting from version 0.6.5 of the package). The latter
might be specified via a covariance extractor function, certain strings
(like <code>"robust"</code> or <code>"HC3"</code>), a clustering formula
(like <code>~ firm</code>), or simply a covariance matrix. Given that we
already computed a list of covariance matrices <code>vc</code> above, we
simply use the list element with the clustered covariance:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://modelsummary.com" class="external-link">"modelsummary"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `modelsummary` 2.0.0 now uses `tinytable` as its default table-drawing</span></span>
<span><span class="co">##   backend. Learn more at: https://vincentarelbundock.github.io/tinytable/</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Revert to `kableExtra` for one session:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   options(modelsummary_factory_default = 'kableExtra')</span></span>
<span><span class="co">##   options(modelsummary_factory_latex = 'kableExtra')</span></span>
<span><span class="co">##   options(modelsummary_factory_html = 'kableExtra')</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Silence this message forever:</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   config_modelsummary(startup_message = FALSE)</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="va">m</span>, vcov <span class="op">=</span> <span class="va">vc</span><span class="op">$</span><span class="va">Clustered</span>, stars <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
 

  
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinytable_dcfxzragvabrovsmqyex</title>
<style>
.table td.tinytable_css_94thguiafxfusws1k2z9, .table th.tinytable_css_94thguiafxfusws1k2z9 {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_ynj9y7xf6no8ma8a9bq9, .table th.tinytable_css_ynj9y7xf6no8ma8a9bq9 {    text-align: left; }
.table td.tinytable_css_ah5pvmzizu09sqomd98n, .table th.tinytable_css_ah5pvmzizu09sqomd98n {    text-align: center; }
.table td.tinytable_css_5iaubq8n9sv3njjlldrq, .table th.tinytable_css_5iaubq8n9sv3njjlldrq {    border-bottom: solid 0.05em black; }
    </style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><div class="container">
      <table class="table table table-borderless" id="tinytable_dcfxzragvabrovsmqyex" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col"> </th>
                <th scope="col">(1)</th>
              </tr></thead>
<tfoot><tr><td colspan="2">+ p &lt; 0.1, * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001</td></tr></tfoot>
<tbody>
<tr>
<td>(Intercept)</td>
                  <td>0.030     </td>
                </tr>
<tr>
<td>           </td>
                  <td>(0.067)   </td>
                </tr>
<tr>
<td>x          </td>
                  <td>1.035***  </td>
                </tr>
<tr>
<td>           </td>
                  <td>(0.051)   </td>
                </tr>
<tr>
<td>Num.Obs.   </td>
                  <td>5000      </td>
                </tr>
<tr>
<td>R2         </td>
                  <td>0.208     </td>
                </tr>
<tr>
<td>R2 Adj.    </td>
                  <td>0.208     </td>
                </tr>
<tr>
<td>AIC        </td>
                  <td>21151.2   </td>
                </tr>
<tr>
<td>BIC        </td>
                  <td>21170.8   </td>
                </tr>
<tr>
<td>Log.Lik.   </td>
                  <td>-10572.604</td>
                </tr>
<tr>
<td>RMSE       </td>
                  <td>2.00      </td>
                </tr>
<tr>
<td>Std.Errors </td>
                  <td>Custom    </td>
                </tr>
</tbody>
</table>
</div>

    <script>
      function styleCell_tinytable_sx6j9m9qscfjpm30vxan(i, j, css_id) {
        var table = document.getElementById("tinytable_dcfxzragvabrovsmqyex");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_dcfxzragvabrovsmqyex');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_sx6j9m9qscfjpm30vxan(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_dcfxzragvabrovsmqyex");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(0, 0, 'tinytable_css_94thguiafxfusws1k2z9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(0, 1, 'tinytable_css_94thguiafxfusws1k2z9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(0, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(1, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(2, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(3, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(4, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(5, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(6, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(7, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(8, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(9, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(10, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(11, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(12, 0, 'tinytable_css_ynj9y7xf6no8ma8a9bq9') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(0, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(1, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(2, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(3, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(4, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(5, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(6, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(7, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(8, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(9, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(10, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(11, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(12, 1, 'tinytable_css_ah5pvmzizu09sqomd98n') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(4, 0, 'tinytable_css_5iaubq8n9sv3njjlldrq') })
window.addEventListener('load', function () { styleCell_tinytable_sx6j9m9qscfjpm30vxan(4, 1, 'tinytable_css_5iaubq8n9sv3njjlldrq') })
    </script><p>The result is a nicely formatted table with content similar to the
verbatim output from the corresponding <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> call
above. (Note that in previous versions of <code><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary()</a></code> the
<code>vcov</code> argument was called <code>statistic_override</code>
which is still supported for backward compatibility.)</p>
<p>Moreover, we can also easily produce such a model summary directly
from the <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> output including the modified standard
errors and test statistics. Even more nicely, this can also be done for
a list of objects. Therefore, we use <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> below to
apply <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> always to the same model
<code>x = m</code> but with the different <code>vcov</code> matrices
from <code>vc</code>. The resulting list of <code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code>
objects can then be displayed directly with <code><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">vc</span>, <span class="va">coeftest</span>, x <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="va">mlist</span><span class="op">)</span></span></code></pre></div>
 

  
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tinytable_vet0q4shw5fgx6t72du3</title>
<style>
.table td.tinytable_css_rhee0z6awrfsesdbzt8s, .table th.tinytable_css_rhee0z6awrfsesdbzt8s {    border-bottom: solid 0.1em #d3d8dc; }
.table td.tinytable_css_ys0uz3sss0uzw5uibdjj, .table th.tinytable_css_ys0uz3sss0uzw5uibdjj {    text-align: left; }
.table td.tinytable_css_h579ltdwm1ipjzrifbtc, .table th.tinytable_css_h579ltdwm1ipjzrifbtc {    text-align: center; }
.table td.tinytable_css_4f3w5fyo3ywvmwihbm6u, .table th.tinytable_css_4f3w5fyo3ywvmwihbm6u {    text-align: center; }
.table td.tinytable_css_avt6lngnxe89m19trra6, .table th.tinytable_css_avt6lngnxe89m19trra6 {    text-align: center; }
.table td.tinytable_css_3mw0el63nosq9fopuulr, .table th.tinytable_css_3mw0el63nosq9fopuulr {    text-align: center; }
.table td.tinytable_css_fs6hpn0c0f28lku4gfyi, .table th.tinytable_css_fs6hpn0c0f28lku4gfyi {    text-align: center; }
.table td.tinytable_css_5nr05ctfi3hulgtwnm8c, .table th.tinytable_css_5nr05ctfi3hulgtwnm8c {    text-align: center; }
.table td.tinytable_css_25ispqdkqrha15927lb0, .table th.tinytable_css_25ispqdkqrha15927lb0 {    text-align: center; }
.table td.tinytable_css_trv8tmnw39xmbp78h378, .table th.tinytable_css_trv8tmnw39xmbp78h378 {    text-align: center; }
.table td.tinytable_css_c3u9yplv9fy0qi540cx6, .table th.tinytable_css_c3u9yplv9fy0qi540cx6 {    text-align: center; }
.table td.tinytable_css_8500380lge3stbuwy3xh, .table th.tinytable_css_8500380lge3stbuwy3xh {    border-bottom: solid 0.05em black; }
    </style>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      },
      svg: {
        fontCache: 'global'
      }
    };
    </script><div class="container">
      <table class="table table table-borderless" id="tinytable_vet0q4shw5fgx6t72du3" style="width: auto; margin-left: auto; margin-right: auto;" data-quarto-disable-processing="true">
<thead><tr>
<th scope="col"> </th>
                <th scope="col">Standard</th>
                <th scope="col">Sandwich (basic)</th>
                <th scope="col">Clustered</th>
                <th scope="col">Clustered (two-way)</th>
                <th scope="col">HC3</th>
                <th scope="col">Andrews' kernel HAC</th>
                <th scope="col">Newey-West</th>
                <th scope="col">Bootstrap</th>
                <th scope="col">Bootstrap (clustered)</th>
              </tr></thead>
<tbody>
<tr>
<td>(Intercept)</td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                  <td>0.030  </td>
                </tr>
<tr>
<td>           </td>
                  <td>(0.028)</td>
                  <td>(0.028)</td>
                  <td>(0.067)</td>
                  <td>(0.065)</td>
                  <td>(0.028)</td>
                  <td>(0.044)</td>
                  <td>(0.066)</td>
                  <td>(0.026)</td>
                  <td>(0.065)</td>
                </tr>
<tr>
<td>x          </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                  <td>1.035  </td>
                </tr>
<tr>
<td>           </td>
                  <td>(0.029)</td>
                  <td>(0.028)</td>
                  <td>(0.051)</td>
                  <td>(0.054)</td>
                  <td>(0.028)</td>
                  <td>(0.035)</td>
                  <td>(0.048)</td>
                  <td>(0.029)</td>
                  <td>(0.054)</td>
                </tr>
<tr>
<td>Num.Obs.   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                  <td>5000   </td>
                </tr>
<tr>
<td>AIC        </td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                  <td>31141.2</td>
                </tr>
<tr>
<td>BIC        </td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                  <td>63714.1</td>
                </tr>
</tbody>
</table>
</div>

    <script>
      function styleCell_tinytable_p1yilr4s310qujj8tzcr(i, j, css_id) {
        var table = document.getElementById("tinytable_vet0q4shw5fgx6t72du3");
        table.rows[i].cells[j].classList.add(css_id);
      }
      function insertSpanRow(i, colspan, content) {
        var table = document.getElementById('tinytable_vet0q4shw5fgx6t72du3');
        var newRow = table.insertRow(i);
        var newCell = newRow.insertCell(0);
        newCell.setAttribute("colspan", colspan);
        // newCell.innerText = content;
        // this may be unsafe, but innerText does not interpret <br>
        newCell.innerHTML = content;
      }
      function spanCell_tinytable_p1yilr4s310qujj8tzcr(i, j, rowspan, colspan) {
        var table = document.getElementById("tinytable_vet0q4shw5fgx6t72du3");
        const targetRow = table.rows[i];
        const targetCell = targetRow.cells[j];
        for (let r = 0; r < rowspan; r++) {
          // Only start deleting cells to the right for the first row (r == 0)
          if (r === 0) {
            // Delete cells to the right of the target cell in the first row
            for (let c = colspan - 1; c > 0; c--) {
              if (table.rows[i + r].cells[j + c]) {
                table.rows[i + r].deleteCell(j + c);
              }
            }
          }
          // For rows below the first, delete starting from the target column
          if (r > 0) {
            for (let c = colspan - 1; c >= 0; c--) {
              if (table.rows[i + r] && table.rows[i + r].cells[j]) {
                table.rows[i + r].deleteCell(j);
              }
            }
          }
        }
        // Set rowspan and colspan of the target cell
        targetCell.rowSpan = rowspan;
        targetCell.colSpan = colspan;
      }

window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 0, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 1, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 2, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 3, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 4, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 5, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 6, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 7, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 8, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 9, 'tinytable_css_rhee0z6awrfsesdbzt8s') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 0, 'tinytable_css_ys0uz3sss0uzw5uibdjj') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 1, 'tinytable_css_h579ltdwm1ipjzrifbtc') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 2, 'tinytable_css_4f3w5fyo3ywvmwihbm6u') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 3, 'tinytable_css_avt6lngnxe89m19trra6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 4, 'tinytable_css_3mw0el63nosq9fopuulr') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 5, 'tinytable_css_fs6hpn0c0f28lku4gfyi') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 6, 'tinytable_css_5nr05ctfi3hulgtwnm8c') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 7, 'tinytable_css_25ispqdkqrha15927lb0') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 8, 'tinytable_css_trv8tmnw39xmbp78h378') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(0, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(1, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(2, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(3, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(5, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(6, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(7, 9, 'tinytable_css_c3u9yplv9fy0qi540cx6') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 0, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 1, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 2, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 3, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 4, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 5, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 6, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 7, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 8, 'tinytable_css_8500380lge3stbuwy3xh') })
window.addEventListener('load', function () { styleCell_tinytable_p1yilr4s310qujj8tzcr(4, 9, 'tinytable_css_8500380lge3stbuwy3xh') })
    </script><p>Note that this includes a reduced list of summary statistics, e.g.,
no R-squared. This could be changed by adding the argument
<code>save = TRUE</code> in the <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> call above. This
would save the full model object in addition to the
<code><a href="https://rdrr.io/pkg/lmtest/man/coeftest.html" class="external-link">coeftest()</a></code> output.</p>
<p>Finally, the different coefficients with corresponding confidence
intervals can be displayed using <code>modelplot(mlist)</code>. In the
figure shown below we add some <em>ggplot2</em>-based customizations to
the plot: omit the display for the intercepts (i.e., only show the
<code>x</code> coefficients), flip the axes, and use a custom color
palette that highlights the confidence intervals based on the disfferent
clustered standard errors which are more appropriate for this data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></span><span class="op">(</span><span class="fl">9</span>, <span class="st">"Dark 3"</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://modelsummary.com/man/modelplot.html" class="external-link">modelplot</a></span><span class="op">(</span><span class="va">mlist</span>, coef_omit <span class="op">=</span> <span class="st">"(Intercept)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">pal</span><span class="op">)</span></span></code></pre></div>
<p><img src="sandwich_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto auto auto 0;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Achim Zeileis, Thomas Lumley.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

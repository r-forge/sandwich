<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>(Clustered) Bootstrap Covariance Matrix Estimation — vcovBS • sandwich</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="(Clustered) Bootstrap Covariance Matrix Estimation — vcovBS"><meta property="og:description" content="Object-oriented estimation of basic bootstrap covariances, using
  simple (clustered) case-based resampling, plus more refined methods
  for lm and glm models."><meta property="og:image" content="https://sandwich.R-Forge.R-project.org/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@AchimZeileis"><meta name="twitter:site" content="@AchimZeileis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sandwich</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sandwich.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jss_2004.html">Econometric Computing with HC and HAC Covariance Matrix Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2006.html">Object-Oriented Computation of Sandwich Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2020.html">Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>(Clustered) Bootstrap Covariance Matrix Estimation</h1>
    
    <div class="hidden name"><code>vcovBS.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Object-oriented estimation of basic bootstrap covariances, using
  simple (clustered) case-based resampling, plus more refined methods
  for <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> and <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> models.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, R <span class="op">=</span> <span class="fl">250</span>, start <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="st">"xy"</span>, <span class="va">...</span>,</span>
<span>  fix <span class="op">=</span> <span class="cn">FALSE</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span>, applyfun <span class="op">=</span> <span class="cn">NULL</span>, cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lm</span></span>
<span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, R <span class="op">=</span> <span class="fl">250</span>, type <span class="op">=</span> <span class="st">"xy"</span>, <span class="va">...</span>,</span>
<span>  fix <span class="op">=</span> <span class="cn">FALSE</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span>, applyfun <span class="op">=</span> <span class="cn">NULL</span>, cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qrjoint <span class="op">=</span> <span class="cn">FALSE</span>, center <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for glm</span></span>
<span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, R <span class="op">=</span> <span class="fl">250</span>, start <span class="op">=</span> <span class="cn">FALSE</span>, type <span class="op">=</span> <span class="st">"xy"</span>, <span class="va">...</span>,</span>
<span>  fix <span class="op">=</span> <span class="cn">FALSE</span>, use <span class="op">=</span> <span class="st">"pairwise.complete.obs"</span>, applyfun <span class="op">=</span> <span class="cn">NULL</span>, cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  center <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a fitted model object.</p></dd>

  <dt>cluster</dt>
<dd><p>a variable indicating the clustering of observations,
    a <code>list</code> (or <code>data.frame</code>) thereof, or a formula specifying
    which variables from the fitted model should be used (see examples).
    By default (<code>cluster = NULL</code>), either <code>attr(x, "cluster")</code> is used
    (if any) or otherwise every observation is assumed to be its own cluster.</p></dd>

  <dt>R</dt>
<dd><p>integer. Number of bootstrap replications.</p></dd>

  <dt>start</dt>
<dd><p>logical. Should <code>coef(x)</code> be passed as <code>start</code>
    to the <code>update(x, subset = ...)</code> call? In case the model <code>x</code>
    is computed by some numeric iteration, this may speed up the bootstrapping.</p></dd>

  <dt>type</dt>
<dd><p>character (or function). The character string specifies the type of
    bootstrap to use: In the default and <code>glm</code> method the three types
    <code>"xy"</code>, <code>"fractional"</code>, and <code>"jackknife"</code> are available.
    In the <code>lm</code> method there are additionally <code>"residual"</code>, <code>"wild"</code>
    (or equivalently: <code>"wild-rademacher"</code> or <code>"rademacher"</code>),
    <code>"mammen"</code> (or <code>"wild-mammen"</code>), <code>"norm"</code>
    (or <code>"wild-norm"</code>), <code>"webb"</code> (or <code>"wild-webb"</code>).
    Finally, for the <code>lm</code> method <code>type</code> can be a <code>function(n)</code>
    for drawing wild bootstrap factors.</p></dd>

  <dt>...</dt>
<dd><p>arguments passed to methods. For the default method, this is
    passed to <code>update</code>, and for the <code>lm</code> method to <code>lm.fit</code>.</p></dd>

  <dt>fix</dt>
<dd><p>logical. Should the covariance matrix be fixed to be
    positive semi-definite in case it is not?</p></dd>

  <dt>use</dt>
<dd><p>character. Specification passed to <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></code> for
    handling missing coefficients/parameters.</p></dd>

  <dt>applyfun</dt>
<dd><p>an optional <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></code>-style function with arguments
    <code>function(X, FUN, ...)</code>. It is used for refitting the model to the
    bootstrap samples. The default is to use the basic <code>lapply</code>
    function unless the <code>cores</code> argument is specified (see below).</p></dd>

  <dt>cores</dt>
<dd><p>numeric. If set to an integer the <code>applyfun</code> is set to    
    <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code> with the desired number of <code>cores</code>,
    except on Windows where <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></code> with
    <code>makeCluster(cores)</code> is used.</p></dd>

  <dt>center</dt>
<dd><p>character. For <code>type = "jackknife"</code> the coefficients from
    all jacknife samples (each dropping one observational unit/cluster) can be
    centered by their <code>"mean"</code> (default) or by the original full-sample
    <code>"estimate"</code>.</p></dd>

  <dt>qrjoint</dt>
<dd><p>logical. For residual-based and wild boostrap (i.e.,
    <code>type != "xy"</code>), should the bootstrap sample the dependent variable
    and then apply the QR decomposition jointly only once? If <code>FALSE</code>,
    the boostrap applies the QR decomposition separately in each iteration
    and samples coefficients directly. If the sample size (and the number of
    coefficients) is large, then <code>qrjoint = TRUE</code> maybe significantly
    faster while requiring much more memory.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Clustered sandwich estimators are used to adjust inference when errors
  are correlated within (but not between) clusters. See the documentation for <code><a href="vcovCL.html">vcovCL</a></code> 
  for specifics about covariance clustering. This function allows
  for clustering in arbitrarily many cluster dimensions (e.g., firm, time, industry), given all
  dimensions have enough clusters (for more details, see Cameron et al. 2011).
  Unlike <code>vcovCL</code>, <code>vcovBS</code> uses a bootstrap rather than an asymptotic solution.</p>
<p>Basic (clustered) bootstrap covariance matrix estimation is provided by
  the default <code>vcovBS</code> method. It samples clusters (where each observation
  is its own cluster by default), i.e., using case-based resampling. For obtaining
  a covariance matrix estimate it is assumed that an <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></code>
  of the model with the resampled <code>subset</code> can be obtained, the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></code>
  extracted, and finally the covariance computed with <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cov</a></code>.</p>  
<p>The <code>update</code> model is evaluated in the <code>environment(terms(x))</code> (if available).
  To speed up computations two further arguments can be leveraged.</p><ol><li><p>Instead of <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></code> a parallelized function such as
      <code><a href="https://rdrr.io/r/parallel/clusterApply.html" class="external-link">parLapply</a></code> or <code><a href="https://rdrr.io/r/parallel/mclapply.html" class="external-link">mclapply</a></code>
      can be specified to iterate over the bootstrap replications. For the latter,
      specifying <code>cores = ...</code> is a convenience shortcut.</p></li>
<li><p>When specifying <code>start = TRUE</code>, the <code>coef(x)</code> are passed to
      <code>update</code> as <code>start = coef(x)</code>. This may not be supported by all
      model fitting functions and is hence not turned on by default.</p></li>
</ol><p>The ``xy'' or ``pairs'' bootstrap is consistent for heteroscedasticity and clustered errors, 
  and converges to the asymptotic solution used in <code>vcovCL</code>
  as <code>R</code>, \(n\), and \(g\) become large (\(n\) and \(g\) are the number of
  observations and the number of clusters, respectively; see Efron 1979, or Mammen 1992, for a 
  discussion of bootstrap asymptotics). For small \(g\) -- particularly under 30 groups -- the
  bootstrap will converge to a slightly different value than the asymptotic method, due to
  the limited number of distinct bootstrap replications possible (see Webb 2014 for a discussion
  of this phenomonon). The bootstrap will not necessarily converge to an asymptotic estimate
  that has been corrected for small samples.</p>  
<p>The xy approach to bootstrapping is generally only of interest to the
  practitioner when the asymptotic solution is unavailable (this can happen when using
  estimators that have no <code>estfun</code> function, for example). The residual bootstrap,
  by contrast, is rarely of practical interest, because while it provides consistent
  inference for clustered standard errors, it is not robust to heteroscedasticity.
  More generally, bootstrapping is useful when the bootstrap makes different assumptions than the asymptotic
  estimator, in particular when the number of clusters is small and large \(n\) or
  \(g\) assumptions are unreasonable. Bootstrapping is also often effective for nonlinear models,
  particularly in smaller samples, where asymptotic approaches often perform relatively poorly.
  See Cameron and Miller (2015) for further discussion of bootstrap techniques in practical applications,
  and Zeileis et al. (2020) show simulations comparing <code>vcovBS</code> to <code>vcovCL</code> in several
  settings.</p>  
<p>The jackknife approach is of particular interest in practice because it can be shown to be
  exactly equivalent to the HC3 (without cluster adjustment, also known as CV3)
  covariance matrix estimator in linear models (see MacKinnon,
  Nielsen, Webb 2022). If the number of observations per cluster is large it may become
  impossible to compute this estimator via <code><a href="vcovCL.html">vcovCL</a></code> while using the jackknife
  approach will still be feasible. In nonlinear models (including non-Gaussian GLMs) the
  jackknife and the HC3 estimator do not coincide but the jackknife might still be a useful
  alternative when the HC3 cannot be computed. A convenience interface <code><a href="vcovJK.html">vcovJK</a></code>
  is provided whose default method simply calls <code>vcovBS(..., type = "jackknife")</code>.</p>
<p>The fractional-random-weight bootstrap (see Xu et al. 2020), first introduced by
  Rubin (1981) as Bayesian bootstrap, is an alternative to the xy bootstrap when it is
  computationally challenging or even impractical to reestimate the model on subsets, e.g.,
  when "successes" in binary responses are rare or when the number of parameters is close
  to the sample size. In these situations excluding some observations completely is the
  source of the problems, i.e., giving some observations zero weight while others receive
  integer weights of one ore more. The fractional bootstrap mitigates this by giving
  every observation a positive fractional weight, drawn from a Dirichlet distribution.
  These may become close to zero but never exclude an observation completly, thus stabilizing
  the computation of the reweighted models.</p>
<p>The <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code> method works essentially like the default method but calls
  <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm.fit</a></code> instead of <code>update</code>.</p>  
<p>The <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> method provides additional bootstrapping <code>type</code>s
  and computes the bootstrapped coefficient estimates somewhat more efficiently using
  <code><a href="https://rdrr.io/r/stats/lmfit.html" class="external-link">lm.fit</a></code> (for case-based resampling) or <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr.coef</a></code>
  rather than <code>update</code>. The default <code>type</code> is case-based resampling
  (<code>type = "xy"</code>) as in the default method. Alternative <code>type</code> specifications are:</p><ul><li><p><code>"residual"</code>. The residual cluster bootstrap resamples the residuals (as above,
      by cluster) which are subsequently added to the fitted values to obtain the bootstrapped
      response variable: \(y^{*} = \hat{y} + e^{*}\).
      Coefficients can then be estimated using <code><a href="https://rdrr.io/r/base/qr.html" class="external-link">qr.coef()</a></code>, reusing the
      QR decomposition from the original fit. As Cameron et al. (2008) point out,
      the residual cluster bootstrap is not well-defined when the clusters are unbalanced as 
      residuals from one cluster cannot be easily assigned to another cluster with different size.
      Hence a warning is issued in that case.</p></li>
<li><p><code>"wild"</code> (or equivalently <code>"wild-rademacher"</code> or <code>"rademacher"</code>).
      The wild cluster bootstrap does not actually resample the residuals but instead reforms the
      dependent variable by multiplying the residual by a randomly drawn value and adding the
      result to the fitted value: \(y^{*} = \hat{y} + e \cdot w\)
      (see Cameron et al. 2008). By default, the factors are drawn from the Rademacher distribution:
      <code>function(n) sample(c(-1, 1), n, replace = TRUE)</code>.</p></li>
<li><p><code>"mammen"</code> (or <code>"wild-mammen"</code>). This draws the wild bootstrap factors as
      suggested by Mammen (1993):
      <code>sample(c(-1, 1) * (sqrt(5) + c(-1, 1))/2, n, replace = TRUE, prob = (sqrt(5) + c(1, -1))/(2 * sqrt(5)))</code>.</p></li>
<li><p><code>"webb"</code> (or <code>"wild-webb"</code>). This implements the six-point distribution
      suggested by Webb (2014), which may improve inference when the number of clusters is small:
      <code>sample(c(-sqrt((3:1)/2), sqrt((1:3)/2)), n, replace = TRUE)</code>.</p></li>
<li><p><code>"norm"</code> (or <code>"wild-norm"</code>). The standard normal/Gaussian distribution
      is used for drawing the wild bootstrap factors: <code>function(n) rnorm(n)</code>.</p></li>
<li><p>User-defined function. This needs of the form as above, i.e., a <code>function(n)</code>
      returning a vector of random wild bootstrap factors of corresponding length.</p></li>
</ul></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix containing the covariance matrix estimate.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cameron AC, Gelbach JB, Miller DL (2008).
  “Bootstrap-Based Improvements for Inference with Clustered Errors”,
  <em>The Review of Economics and Statistics</em>, <b>90</b>(3), 414--427.
  <a href="https://doi.org/10.3386/t0344" class="external-link">doi:10.3386/t0344</a></p>  
<p>Cameron AC, Gelbach JB, Miller DL (2011).
  “Robust Inference with Multiway Clustering”,
  <em>Journal of Business &amp; Economic Statistics</em>, <b>29</b>(2), 238--249.
  <a href="https://doi.org/10.1198/jbes.2010.07136" class="external-link">doi:10.1198/jbes.2010.07136</a></p>  
<p>Cameron AC, Miller DL (2015). 
  “A Practitioner's Guide to Cluster-Robust Inference”, 
  <em>Journal of Human Resources</em>, <b>50</b>(2), 317--372.
  <a href="https://doi.org/10.3368/jhr.50.2.317" class="external-link">doi:10.3368/jhr.50.2.317</a></p>  
<p>Efron B (1979). 
  “Bootstrap Methods: Another Look at the Jackknife”, 
  <em>The Annals of Statistics</em>, <b>7</b>(1), 1--26.
  <a href="https://doi.org/10.1214/aos/1176344552" class="external-link">doi:10.1214/aos/1176344552</a></p>  
<p>MacKinnon JG, Nielsen MØ, Webb MD (2022). 
  “Cluster-Robust Inference: A Guide to Empirical Practice”, 
  <em>Journal of Econometrics</em>, Forthcoming.
  <a href="https://doi.org/10.1016/j.jeconom.2022.04.001" class="external-link">doi:10.1016/j.jeconom.2022.04.001</a></p>  
<p>Mammen E (1992). 
  “When Does Bootstrap Work?: Asymptotic Results and Simulations”, 
  <em>Lecture Notes in Statistics</em>, <b>77</b>.
  Springer Science &amp; Business Media.</p>  
<p>Mammen E (1993). 
  “Bootstrap and Wild Bootstrap for High Dimensional Linear Models”, 
  <em>The Annals of Statistics</em>, <b>21</b>(1), 255--285.
  <a href="https://doi.org/10.1214/aos/1176349025" class="external-link">doi:10.1214/aos/1176349025</a></p>
<p>Rubin DB (1981).
  “The Bayesian Bootstrap”,
  <em>The Annals of Statistics</em>, <b>9</b>(1), 130--134.
  <a href="https://doi.org/10.1214/aos/1176345338" class="external-link">doi:10.1214/aos/1176345338</a></p>  
<p>Webb MD (2014).
  “Reworking Wild Bootstrap Based Inference for Clustered Errors”,
  Working Paper 1315, <em>Queen's Economics Department.</em>
  <a href="https://www.econ.queensu.ca/sites/econ.queensu.ca/files/qed_wp_1315.pdf" class="external-link">https://www.econ.queensu.ca/sites/econ.queensu.ca/files/qed_wp_1315.pdf</a>.</p>
<p>Xu L, Gotwalt C, Hong Y, King CB, Meeker WQ (2020).
  “Applications of the Fractional-Random-Weight Bootstrap”,
  <em>The American Statistician</em>, <b>74</b>(4), 345--358.
  <a href="https://doi.org/10.1080/00031305.2020.1731599" class="external-link">doi:10.1080/00031305.2020.1731599</a></p>
<p>Zeileis A, Köll S, Graham N (2020).
  “Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R.”
  <em>Journal of Statistical Software</em>, <b>95</b>(1), 1--36.
  <a href="https://doi.org/10.18637/jss.v095.i01" class="external-link">doi:10.18637/jss.v095.i01</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="vcovCL.html">vcovCL</a></code>, <code><a href="vcovJK.html">vcovJK</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Petersen's data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PetersenCL"</span>, package <span class="op">=</span> <span class="st">"sandwich"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">PetersenCL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## comparison of different standard errors</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"classical"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"HC-cluster"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="vcovCL.html">vcovCL</a></span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"BS-cluster"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"FW-cluster"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span>, type <span class="op">=</span> <span class="st">"fractional"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              classical HC-cluster BS-cluster FW-cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.02835932 0.06701270 0.07067533 0.06596187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x           0.02858329 0.05059573 0.04878784 0.04965168</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## two-way wild cluster bootstrap with Mammen distribution</span></span></span>
<span class="r-in"><span><span class="fu">vcovBS</span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span> <span class="op">+</span> <span class="va">year</span>, type <span class="op">=</span> <span class="st">"wild-mammen"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             (Intercept)           x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept) 0.004135069 0.000364327</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x           0.000364327 0.002659964</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## jackknife estimator coincides with HC3 (aka CV3)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">vcovBS</span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span>, type <span class="op">=</span> <span class="st">"jackknife"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="vcovCL.html">vcovCL</a></span><span class="op">(</span><span class="va">m</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span>, type <span class="op">=</span> <span class="st">"HC3"</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  tolerance <span class="op">=</span> <span class="fl">1e-7</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Achim Zeileis, Thomas Lumley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>


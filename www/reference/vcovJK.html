<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>(Clustered) Jackknife Covariance Matrix Estimation — vcovJK • sandwich</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="(Clustered) Jackknife Covariance Matrix Estimation — vcovJK"><meta property="og:description" content="Object-oriented estimation of jackknife covariances, i.e., based on
  the centered outer product of leave-on-out estimates of the model
  coefficients/parameters."><meta property="og:image" content="https://sandwich.R-Forge.R-project.org/logo.png"><meta name="twitter:card" content="summary"><meta name="twitter:creator" content="@AchimZeileis"><meta name="twitter:site" content="@AchimZeileis"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sandwich</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">3.1-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/sandwich.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jss_2004.html">Econometric Computing with HC and HAC Covariance Matrix Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2006.html">Object-Oriented Computation of Sandwich Estimators</a>
    </li>
    <li>
      <a href="../articles/jss_2020.html">Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
<li>
  <a href="../contact.html">Contact</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>(Clustered) Jackknife Covariance Matrix Estimation</h1>
    
    <div class="hidden name"><code>vcovJK.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Object-oriented estimation of jackknife covariances, i.e., based on
  the centered outer product of leave-on-out estimates of the model
  coefficients/parameters.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">vcovJK</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for default</span>
<span class="fu">vcovJK</span><span class="op">(</span><span class="va">x</span>, cluster <span class="op">=</span> <span class="cn">NULL</span>, center <span class="op">=</span> <span class="st">"mean"</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a fitted model object.</p></dd>
<dt>cluster</dt>
<dd><p>a variable indicating the clustering of observations,
    a <code>list</code> (or <code>data.frame</code>) thereof, or a formula specifying
    which variables from the fitted model should be used (see examples).
    By default (<code>cluster = NULL</code>), either <code>attr(x, "cluster")</code> is used
    (if any) or otherwise every observation is assumed to be its own cluster.</p></dd>
<dt>center</dt>
<dd><p>character specifying how to center the coefficients from
    all jacknife samples (each dropping one observational unit/cluster).
    By default the coefficients are centered by their <code>"mean"</code> across the
    sample or, alternatively, by the original full-sample <code>"estimate"</code>.</p></dd>
<dt>...</dt>
<dd><p>arguments passed to methods. For the default method, this is
    passed to <code><a href="vcovBS.html">vcovBS</a></code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Jackknife covariance estimation is based on leave-one-out estimates of the
  coefficients/parameters of a model. This means that the model is reestimated
  after dropping each observational unit once, i.e., each individual observation
  in independent observations or each cluster in dependent data. The covariance
  matrix is then constructed from the scaled outer product of the centered
  jackknife estimates. Centering can either be done by the mean of the jackknife
  coefficients (default) or by the original full-sample estimates. Scaling is done
  by (N - 1)/N where N is the number of observational units.</p>  
<p>Recent research has shown that the jackknife covariance estimate have particularly
  useful properties in practice: they are not downward biased and yield better
  coverage rates for confidence intervals compared to other "robust" covariance
  estimates. See MacKinnon et al. (2022) and Hansen (2022) for more details.</p>  
<p>As jackknife covariances are also based on reestimation of the coefficients on
  subsamples, their computation is very similar to bootstrap covariances. Hence,
  the <code><a href="vcovBS.html">vcovBS</a></code> methods provided in the package all offer an argument
  <code>vcovBS(..., type = "jackknife")</code>. This is called by the default
  <code>vcovJK</code> method. Therefore, see the arguments of <code>vcovBS</code> for further
  details, e.g., for leveraging multicore computations etc.</p>
<p>In the linear regression model, the jackknife covariance can actually be computed
  without reestimating the coefficients but using only the full-sample estimates and
  certain elements of the so-called hat matrix. Namly the diagonal elements or
  blocks of elements from the hat matrix are needed for independent observations and
  clustered data, respectively. These alternative computations of the jackknife
  covariances are available in <code><a href="vcovHC.html">vcovHC</a></code> and <code><a href="vcovCL.html">vcovCL</a></code>, respectively,
  in both cases with argument <code>type = "HC3"</code>. To obtain HC3 covariances that exactly
  match the jackknife covariances, the jackknife has to be centered with the full-sample
  estimates and the right finite-sample adjustment has to be selected for the HC3.</p>  
<p>In small to moderate sample sizes, the HC3 estimation techniques are typically much
  faster than the jackknife. However, in large samples it may become impossible to
  compute the HC3 covariances while the jackknife approach is still feasible.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix containing the covariance matrix estimate.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bell RM, McCaffrey DF (2002).
  “Bias Reduction in Standard Errors for Linear Regression with Multi-Stage Samples”,
  <em>Survey Methodology</em>, <b>28</b>(2), 169--181.</p>
<p>Hansen BE (2022).
  “Jackknife Standard Errors for Clustered Regression”, Working Paper, August 2022.
  <a href="https://www.ssc.wisc.edu/~bhansen/papers/tcauchy.html" class="external-link">https://www.ssc.wisc.edu/~bhansen/papers/tcauchy.html</a></p>
<p>MacKinnon JG, Nielsen MØ, Webb MD (2022). 
  “Cluster-Robust Inference: A Guide to Empirical Practice”, 
  <em>Journal of Econometrics</em>, Forthcoming.
  <a href="https://doi.org/10.1016/j.jeconom.2022.04.001" class="external-link">doi:10.1016/j.jeconom.2022.04.001</a></p>  
<p>Zeileis A, Köll S, Graham N (2020).
  “Various Versatile Variances: An Object-Oriented Implementation of Clustered Covariances in R.”
  <em>Journal of Statistical Software</em>, <b>95</b>(1), 1--36.
  <a href="https://doi.org/10.18637/jss.v095.i01" class="external-link">doi:10.18637/jss.v095.i01</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>vcovJK</code>, <code><a href="vcovHC.html">vcovHC</a></code>, <code><a href="vcovCL.html">vcovCL</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co">## cross-section data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PublicSchools"</span>, package <span class="op">=</span> <span class="st">"sandwich"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">Expenditure</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></span><span class="op">(</span><span class="va">Income</span>, <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">PublicSchools</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">vcovJK</span><span class="op">(</span><span class="va">m1</span>, center <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  (Intercept) poly(Income, 2)1 poly(Income, 2)2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         97.84092         1055.131         1370.855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poly(Income, 2)1  1055.13101        25053.095        31336.158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poly(Income, 2)2  1370.85525        31336.158        46955.800</span>
<span class="r-in"><span class="fu"><a href="vcovHC.html">vcovHC</a></span><span class="op">(</span><span class="va">m1</span>, type <span class="op">=</span> <span class="st">"HC3"</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">m1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  (Intercept) poly(Income, 2)1 poly(Income, 2)2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)         97.84092         1055.131         1370.855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poly(Income, 2)1  1055.13101        25053.095        31336.158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> poly(Income, 2)2  1370.85525        31336.158        46955.800</span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## clustered data</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"PetersenCL"</span>, package <span class="op">=</span> <span class="st">"sandwich"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">PetersenCL</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## jackknife estimator coincides with HC3 (aka CV3)</span></span>
<span class="r-in"><span class="fu">vcovJK</span><span class="op">(</span><span class="va">m2</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span>, center <span class="op">=</span> <span class="st">"estimate"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)             x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.499186e-03 -6.714627e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x           -6.714627e-05  2.577098e-03</span>
<span class="r-in"><span class="fu"><a href="vcovCL.html">vcovCL</a></span><span class="op">(</span><span class="va">m2</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">firm</span>, type <span class="op">=</span> <span class="st">"HC3"</span>, cadjust <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               (Intercept)             x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)  4.499186e-03 -6.714627e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x           -6.714627e-05  2.577098e-03</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Achim Zeileis, Thomas Lumley.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>

